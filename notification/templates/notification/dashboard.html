{% extends "notification/base.html" %}

{% block title %}Weather Notifications Page{% endblock %}

{% block content %}
<h1 class="mb-4">Weather Notifications Page</h1>

<!-- filters -->
<form method="get" class="row g-3 mb-4">
    <div class="col-md-4">
        <label for="area" class="form-label">Area</label>
        <input type="text" class="form-control" name="area" id="area" value="{{ request.GET.area }}">
    </div>
    <div class="col-md-4">
        <label for="severity" class="form-label">Severity</label>
        <select class="form-select" name="severity" id="severity">
            <option value="">All</option>
            <option value="Severe" {% if request.GET.severity == 'Severe' %}selected{% endif %}>Severe</option>
            <option value="Moderate" {% if request.GET.severity == 'Moderate' %}selected{% endif %}>Moderate</option>
            <option value="Minor" {% if request.GET.severity == 'Minor' %}selected{% endif %}>Minor</option>
        </select>
    </div>
    <div class="col-md-4">
        <label for="urgency" class="form-label">Urgency</label>
        <select class="form-select" name="urgency" id="urgency">
            <option value="">All</option>
            <option value="Immediate" {% if request.GET.urgency == 'Immediate' %}selected{% endif %}>Immediate</option>
            <option value="Expected" {% if request.GET.urgency == 'Expected' %}selected{% endif %}>Expected</option>
            <option value="Future" {% if request.GET.urgency == 'Future' %}selected{% endif %}>Future</option>
            <option value="Past" {% if request.GET.urgency == 'Past' %}selected{% endif %}>Past</option>
            <option value="Unknown" {% if request.GET.urgency == 'Unknown' %}selected{% endif %}>Unknown</option>
        </select>
    </div>
    <div class="col-12 text-end">
        <button type="submit" class="btn btn-primary mt-3">Filter</button>
        <a href="{% url 'dashboard' %}" class="btn btn-secondary mt-3">Reset</a>
    </div>
</form>
<!-- alerts table -->
{% if alerts %}
<div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>Event</th>
                <th>Area</th>
                <th>Severity</th>
                <th>Urgency</th>
                <th>Sent</th>
                <th>Expires</th>
            </tr>
        </thead>
        <tbody>
        {% for alert in alerts %}
            <tr class="{% if alert.severity|lower == 'severe' %}table-danger{% elif alert.severity|lower == 'moderate' %}table-warning{% elif alert.severity|lower == 'minor' %}table-info{% endif %}">
                <td>{{ alert.event }}</td>
                <td>{{ alert.area_desc }}</td>
                <td>{{ alert.severity }}</td>
                <td>{{ alert.urgency }}</td>
                <td>{{ alert.sent|date:"Y-m-d H:i" }}</td>
                <td>{{ alert.expires|date:"Y-m-d H:i" }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="alert alert-success">No active alerts at this time.</div>
{% endif %}
{% endblock %}
